{"version":3,"sources":["../src/vanilla-collapsible-content.js"],"names":["_","require","ViewportDetectionClass","includes","viewport","VanillaCollapsibleContentClass","config","init","defaults","bodyContainerClass","itemContainerClass","toggleContainerClass","_initViewport","_init","bodies","items","toggles","dataName","element","getAttribute","_render","device","getDevice","size","windowSize","trackSize","_trackSize","bind","_getItems","_getToggles","_getBodies","_setBreakpointDefaults","forEach","toggle","addEventListener","_toggleClick","map","item","querySelector","_setBodyIDs","dataParent","querySelectorAll","Array","from","filter","_setVisibleItems","_setToggleAriaControls","_addToggleClickListeners","body","_skipTextNodes","nextSibling","attribute","setAttribute","className","replace","i","id","isNull","_setDefaults","visibleMobile","visibleTablet","visibleDesktop","visible","_setDefaultToggleAriaExpandeds","_setDefaultToggleClasses","_setDefaultBodyAriaHiddens","_setDefaultBodyClasses","el","method","nodeType","e","preventDefault","_setToggleAriaExpanded","_setToggleClass","_setBodyAriaHidden","_setBodyClass","module","exports"],"mappings":"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","file":"vanilla-collapsible-content.js","sourcesContent":["/* eslint-disable max-len */\nconst _ = require('lodash/core')\n    , ViewportDetectionClass = require('viewport-detection-es6');\n\n_.includes = require('lodash/includes');\nconst viewport = new ViewportDetectionClass();\n\nclass VanillaCollapsibleContentClass{\n  constructor(config = {}, init = true){\n    this.config = _.defaults(config,\n      {\n        bodyContainerClass: 'collapsible-content-body'\n      , itemContainerClass: 'collapsible-content-item'\n      , toggleContainerClass: 'collapsible-content-toggle'\n      }\n    );\n\n    if (init){\n      this._initViewport();\n      this._init();\n    }\n  }\n\n  _init(){\n    this.bodies = [];\n    this.items = [];\n    this.toggles = [];\n    this.dataName = this.config.element.getAttribute('data-name');\n    this._render();\n  }\n\n  _initViewport(){\n    this.device = viewport.getDevice();\n    this.size = viewport.windowSize();\n    viewport.trackSize(this._trackSize.bind(this));\n  }\n\n  _render(){\n    this._getItems();\n    this._getToggles();\n    this._getBodies();\n    this._setBreakpointDefaults();\n  }\n\n  _addToggleClickListeners(){\n    this.toggles.forEach((toggle)=>{\n      toggle.addEventListener('click'\n                             , this._toggleClick.bind(this, toggle)\n                             , false);\n    });\n  }\n\n  _getBodies(){\n    this.bodies = this.items.map((item)=>{\n      return item.querySelector(`.${this.config.bodyContainerClass}`);\n    });\n\n    this._setBodyIDs();\n  }\n\n  _getItems(){\n    let dataParent;\n    const items = this.config.element.querySelectorAll(`.${this.config.itemContainerClass}`);\n\n    this.items = Array.from(items).filter((item)=>{\n      dataParent = item.getAttribute('data-parent');\n\n      return dataParent === this.dataName;\n    });\n\n    this._setVisibleItems();\n  }\n\n  _getToggles(){\n    this.toggles = this.items.map((item)=>{\n      return item.querySelector(`.${this.config.toggleContainerClass}`);\n    });\n\n    this._setToggleAriaControls();\n    this._addToggleClickListeners();\n  }\n\n  _setBodyAriaHidden(toggle){\n    let body = this._skipTextNodes(toggle.nextSibling, 'nextSibling');\n    let attribute = body.getAttribute('aria-hidden');\n\n    body.setAttribute('aria-hidden', (attribute === 'true') ? 'false' : 'true');\n  }\n\n  _setBodyClass(toggle){\n    let body = this._skipTextNodes(toggle.nextSibling, 'nextSibling');\n    let className = body.className;\n\n    if (_.includes(className, 'open')){\n      body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n    } else {\n      body.className = className += ' open';\n    }\n  }\n\n  _setBodyIDs(){\n    this.bodies.forEach((body, i)=>{\n      body.id += _.isNull(this.dataName) ? `collapsible-${i}` : `${this.dataName}-collapsible-${i}`;\n    });\n  }\n\n  _setBreakpointDefaults(){\n    switch (this.device){\n      case 'mobile':\n        this._setDefaults(this.visibleMobile);\n        break;\n      case 'tablet':\n        this._setDefaults(this.visibleTablet);\n        break;\n      case 'desktop':\n        this._setDefaults(this.visibleDesktop);\n        break;\n      default:\n        break;\n    }\n  }\n\n  _setDefaultBodyAriaHiddens(visible){\n    this.bodies.forEach((body)=>{\n      body.setAttribute('aria-hidden', (visible === 'true') ? 'false' : 'true');\n    });\n  }\n\n  _setDefaultBodyClasses(visible){\n    let className;\n\n    this.bodies.forEach((body)=>{\n      className = body.className;\n\n      if (visible === 'true'){\n        if (!_.includes(className, 'open')){\n          body.className = className += ' open';\n        }\n      } else {\n        body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n      }\n    });\n  }\n\n  _setDefaults(visible){\n    this._setDefaultToggleAriaExpandeds(visible);\n    this._setDefaultToggleClasses(visible);\n    this._setDefaultBodyAriaHiddens(visible);\n    this._setDefaultBodyClasses(visible);\n  }\n\n  _setDefaultToggleAriaExpandeds(visible){\n    this.toggles.forEach((toggle)=>{\n      toggle.setAttribute('aria-expanded', (visible === 'true') ? 'true' : 'false');\n    });\n  }\n\n  _setDefaultToggleClasses(visible){\n    let className;\n\n    this.toggles.forEach((toggle)=>{\n      className = toggle.className;\n\n      if (visible === 'true'){\n        if (!_.includes(className, 'open')){\n          toggle.className = className += ' open';\n        }\n      } else {\n        toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n      }\n    });\n  }\n\n  _setToggleAriaControls(){\n    this.toggles.forEach((toggle, i)=>{\n      toggle.setAttribute('aria-controls', _.isNull(this.dataName) ? `collapsible-${i}` : `${this.dataName}-collapsible-${i}`);\n    });\n  }\n\n  _setToggleAriaExpanded(toggle){\n    let attribute = toggle.getAttribute('aria-expanded');\n\n    toggle.setAttribute('aria-expanded', (attribute === 'true') ? 'false' : 'true');\n  }\n\n  _setToggleClass(toggle){\n    let className = toggle.className;\n\n    if (_.includes(className, 'open')){\n      toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n    } else {\n      toggle.className = className += ' open';\n    }\n  }\n\n  _setVisibleItems(){\n    const visibleMobile = this.config.element.getAttribute('data-visible-mobile');\n    const visibleTablet = this.config.element.getAttribute('data-visible-tablet');\n    const visibleDesktop = this.config.element.getAttribute('data-visible-desktop');\n\n    this.visibleMobile = (_.isNull(visibleMobile)) ? 'false' : visibleMobile;\n    this.visibleTablet = (_.isNull(visibleTablet)) ? 'false' : visibleTablet;\n    this.visibleDesktop = (_.isNull(visibleDesktop)) ? 'false' : visibleDesktop;\n  }\n\n  _skipTextNodes(el, method){\n    let element = el[method];\n\n    while (element !== null && element.nodeType !== 1){\n      element = element.nextSibling;\n    }\n\n    return element;\n  }\n\n  _toggleClick(toggle, e){\n    e.preventDefault();\n\n    this._setToggleAriaExpanded(toggle);\n    this._setToggleClass(toggle);\n    this._setBodyAriaHidden(toggle);\n    this._setBodyClass(toggle);\n  }\n\n  _trackSize(device, size){\n    if (this.device !== device){\n      this.device = device;\n\n      this._setBreakpointDefaults();\n    }\n\n    this.size = size;\n  }\n}\n\nmodule.exports = VanillaCollapsibleContentClass;\n/* eslint-enable */\n\n"]}