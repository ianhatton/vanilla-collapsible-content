{"version":3,"sources":["../src/vanilla-collapsible-content.js"],"names":[],"mappings":";;;;;;AAAA,IAAM,IAAI,QAAQ,aAAR,CAAV;AAAA,IACM,yBAAyB,QAAQ,wBAAR,CAD/B;;AAGA,EAAE,QAAF,GAAa,QAAQ,iBAAR,CAAb;AACA,IAAM,WAAW,IAAI,sBAAJ,EAAjB;;IAEM,8B;AACJ,4CAAqC;AAAA,QAAzB,MAAyB,yDAAhB,EAAgB;AAAA,QAAZ,IAAY,yDAAL,IAAK;;AAAA;;AACnC,SAAK,MAAL,GAAc,EAAE,QAAF,CAAW,MAAX,EACZ;AACE,0BAAoB,0BADtB;AAEE,0BAAoB,0BAFtB;AAGE,4BAAsB;AAHxB,KADY,CAAd;;AAQA,QAAI,IAAJ,EAAS;AACP,WAAK,aAAL;AACA,WAAK,KAAL;AACD;AACF;;;;4BAEM;AACL,WAAK,MAAL,GAAc,EAAd;AACA,WAAK,KAAL,GAAa,EAAb;AACA,WAAK,OAAL,GAAe,EAAf;AACA,WAAK,QAAL,GAAgB,KAAK,MAAL,CAAY,OAAZ,CAAoB,YAApB,CAAiC,WAAjC,CAAhB;AACA,WAAK,OAAL;AACD;;;oCAEc;AACb,WAAK,MAAL,GAAc,SAAS,SAAT,EAAd;AACA,WAAK,IAAL,GAAY,SAAS,UAAT,EAAZ;AACA,eAAS,SAAT,CAAmB,KAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAAnB;AACD;;;8BAEQ;AACP,WAAK,SAAL;AACA,WAAK,WAAL;AACA,WAAK,UAAL;AACA,WAAK,sBAAL;AACD;;;+CAEyB;AACxB,QAAE,OAAF,CAAU,KAAK,OAAf,EAAwB,UAAS,MAAT,EAAgB;AACtC,eAAO,gBAAP,CAAwB,OAAxB,EACyB,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,EAA6B,MAA7B,CADzB,EAEyB,KAFzB;AAGD,OAJuB,CAItB,IAJsB,CAIjB,IAJiB,CAAxB;AAKD;;;iCAEW;AACV,QAAE,OAAF,CAAU,KAAK,KAAf,EAAsB,UAAS,IAAT,EAAc;AAClC;AACA,aAAK,MAAL,CAAY,IAAZ,CAAiB,KAAK,aAAL,CAAmB,MAAM,KAAK,MAAL,CAAY,kBAArC,CAAjB;AACA;AACD,OAJqB,CAIpB,IAJoB,CAIf,IAJe,CAAtB;;AAMA,WAAK,eAAL;AACD;;;gCAEU;AACT,UAAI,mBAAJ;AACA;AACA,UAAI,QAAQ,KAAK,MAAL,CAAY,OAAZ,CAAoB,gBAApB,CAAqC,MAAM,KAAK,MAAL,CAAY,kBAAvD,CAAZ;AACE;;AAEF,QAAE,OAAF,CAAU,KAAV,EAAiB,UAAS,IAAT,EAAc;AAC7B,qBAAa,KAAK,YAAL,CAAkB,aAAlB,CAAb;;AAEA,YAAI,eAAe,KAAK,QAAxB,EAAiC;AAC/B,eAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB;AACD;AACF,OANgB,CAMf,IANe,CAMV,IANU,CAAjB;;AAQA,WAAK,gBAAL;AACD;;;kCAEY;AACX,QAAE,OAAF,CAAU,KAAK,KAAf,EAAsB,UAAS,IAAT,EAAc;AAClC;AACA,aAAK,OAAL,CAAa,IAAb,CAAkB,KAAK,aAAL,CAAmB,MAAM,KAAK,MAAL,CAAY,oBAArC,CAAlB;AACA;AACD,OAJqB,CAIpB,IAJoB,CAIf,IAJe,CAAtB;;AAMA,WAAK,sBAAL;AACA,WAAK,wBAAL;AACD;;;uCAEkB,M,EAAO;AACxB,UAAI,OAAO,KAAK,cAAL,CAAoB,OAAO,WAA3B,EAAwC,aAAxC,CAAX;AACA,UAAI,YAAY,KAAK,YAAL,CAAkB,aAAlB,CAAhB;;AAEA,WAAK,YAAL,CAAkB,aAAlB,EAAkC,cAAc,MAAf,GAAyB,OAAzB,GAAmC,MAApE;AACD;;;kCAEa,M,EAAO;AACnB,UAAI,OAAO,KAAK,cAAL,CAAoB,OAAO,WAA3B,EAAwC,aAAxC,CAAX;AACA,UAAI,YAAY,KAAK,SAArB;;AAEA,UAAI,EAAE,QAAF,CAAW,SAAX,EAAsB,MAAtB,CAAJ,EAAkC;AAChC,aAAK,SAAL,GAAiB,UAAU,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAjB;AACD,OAFD,MAEO;AACL,aAAK,SAAL,GAAiB,aAAa,OAA9B;AACD;AACF;;;sCAEgB;AACf,QAAE,OAAF,CAAU,KAAK,MAAf,EAAuB,UAAS,IAAT,EAAe,CAAf,EAAiB;AACtC,aAAK,SAAL,IAAmB,EAAE,MAAF,CAAS,KAAK,QAAd,CAAD,GAA4B,kBAAkB,CAA9C,GAAkD,MAAM,KAAK,QAAX,GAAsB,eAAtB,GAAwC,CAA5G;AACD,OAFsB,CAErB,IAFqB,CAEhB,IAFgB,CAAvB;AAGD;;;6CAEuB;AACtB,cAAQ,KAAK,MAAb;AACE,aAAK,QAAL;AACE,eAAK,YAAL,CAAkB,KAAK,aAAvB;AACA;AACF,aAAK,QAAL;AACE,eAAK,YAAL,CAAkB,KAAK,aAAvB;AACA;AACF,aAAK,SAAL;AACE,eAAK,YAAL,CAAkB,KAAK,cAAvB;AACA;AACF;AACE;AAXJ;AAaD;;;+CAE0B,O,EAAQ;AACjC,QAAE,OAAF,CAAU,KAAK,MAAf,EAAuB,UAAS,IAAT,EAAc;AACnC,aAAK,YAAL,CAAkB,aAAlB,EAAkC,YAAY,MAAb,GAAuB,OAAvB,GAAiC,MAAlE;AACD,OAFD;AAGD;;;2CAEsB,O,EAAQ;AAC7B,QAAE,OAAF,CAAU,KAAK,MAAf,EAAuB,UAAS,IAAT,EAAc;AACnC,YAAI,YAAY,KAAK,SAArB;;AAEA,YAAI,YAAY,MAAhB,EAAuB;AACrB,cAAI,CAAC,EAAE,QAAF,CAAW,SAAX,EAAsB,MAAtB,CAAL,EAAmC;AACjC,iBAAK,SAAL,GAAiB,aAAa,OAA9B;AACD;AACF,SAJD,MAIO;AACL,eAAK,SAAL,GAAiB,UAAU,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAjB;AACD;AACF,OAVD;AAWD;;;iCAEY,O,EAAQ;AACnB,WAAK,8BAAL,CAAoC,OAApC;AACA,WAAK,wBAAL,CAA8B,OAA9B;AACA,WAAK,0BAAL,CAAgC,OAAhC;AACA,WAAK,sBAAL,CAA4B,OAA5B;AACD;;;mDAE8B,O,EAAQ;AACrC,QAAE,OAAF,CAAU,KAAK,OAAf,EAAwB,UAAS,MAAT,EAAgB;AACtC,eAAO,YAAP,CAAoB,eAApB,EAAsC,YAAY,MAAb,GAAuB,MAAvB,GAAgC,OAArE;AACD,OAFD;AAGD;;;6CAEwB,O,EAAQ;AAC/B,QAAE,OAAF,CAAU,KAAK,OAAf,EAAwB,UAAS,MAAT,EAAgB;AACtC,YAAI,YAAY,OAAO,SAAvB;;AAEA,YAAI,YAAY,MAAhB,EAAuB;AACrB,cAAI,CAAC,EAAE,QAAF,CAAW,SAAX,EAAsB,MAAtB,CAAL,EAAmC;AACjC,mBAAO,SAAP,GAAmB,aAAa,OAAhC;AACD;AACF,SAJD,MAIO;AACL,iBAAO,SAAP,GAAmB,UAAU,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAnB;AACD;AACF,OAVD;AAWD;;;6CAEuB;AACtB,QAAE,OAAF,CAAU,KAAK,OAAf,EAAwB,UAAS,MAAT,EAAiB,CAAjB,EAAmB;AACzC,eAAO,YAAP,CAAoB,eAApB,EAAsC,EAAE,MAAF,CAAS,KAAK,QAAd,CAAD,GAA4B,iBAAiB,CAA7C,GAAiD,KAAK,QAAL,GAAgB,eAAhB,GAAkC,CAAxH;AACD,OAFuB,CAEtB,IAFsB,CAEjB,IAFiB,CAAxB;AAGD;;;2CAEsB,M,EAAO;AAC5B,UAAI,YAAY,OAAO,YAAP,CAAoB,eAApB,CAAhB;;AAEA,aAAO,YAAP,CAAoB,eAApB,EAAsC,cAAc,MAAf,GAAyB,OAAzB,GAAmC,MAAxE;AACD;;;oCAEe,M,EAAO;AACrB,UAAI,YAAY,OAAO,SAAvB;;AAEA,UAAI,EAAE,QAAF,CAAW,SAAX,EAAsB,MAAtB,CAAJ,EAAkC;AAChC,eAAO,SAAP,GAAmB,UAAU,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAnB;AACD,OAFD,MAEO;AACL,eAAO,SAAP,GAAmB,aAAa,OAAhC;AACD;AACF;;;uCAEiB;AAChB,UAAI,gBAAgB,KAAK,MAAL,CAAY,OAAZ,CAAoB,YAApB,CAAiC,qBAAjC,CAApB;AACA,UAAI,gBAAgB,KAAK,MAAL,CAAY,OAAZ,CAAoB,YAApB,CAAiC,qBAAjC,CAApB;AACA,UAAI,iBAAiB,KAAK,MAAL,CAAY,OAAZ,CAAoB,YAApB,CAAiC,sBAAjC,CAArB;;AAEA,WAAK,aAAL,GAAsB,EAAE,MAAF,CAAS,aAAT,CAAD,GAA4B,OAA5B,GAAsC,aAA3D;AACA,WAAK,aAAL,GAAsB,EAAE,MAAF,CAAS,aAAT,CAAD,GAA4B,OAA5B,GAAsC,aAA3D;AACA,WAAK,cAAL,GAAuB,EAAE,MAAF,CAAS,cAAT,CAAD,GAA6B,OAA7B,GAAuC,cAA7D;AACD;;;mCAEc,E,EAAI,M,EAAO;AACxB,UAAI,UAAU,GAAG,MAAH,CAAd;;AAEA,aAAO,YAAY,IAAZ,IAAoB,QAAQ,QAAR,KAAqB,CAAhD,EAAkD;AAChD,kBAAU,QAAQ,WAAlB;AACD;;AAED,aAAO,OAAP;AACD;;;iCAEY,M,EAAQ,C,EAAE;AACrB,QAAE,cAAF;;AAEA,WAAK,sBAAL,CAA4B,MAA5B;AACA,WAAK,eAAL,CAAqB,MAArB;AACA,WAAK,kBAAL,CAAwB,MAAxB;AACA,WAAK,aAAL,CAAmB,MAAnB;AACD;;;+BAEU,M,EAAQ,I,EAAK;AACtB,UAAI,KAAK,MAAL,KAAgB,MAApB,EAA2B;AACzB,aAAK,MAAL,GAAc,MAAd;;AAEA,aAAK,sBAAL;AACD;;AAED,WAAK,IAAL,GAAY,IAAZ;AACD;;;;;;AAGH,OAAO,OAAP,GAAiB,8BAAjB","file":"vanilla-collapsible-content.js","sourcesContent":["const _ = require('lodash/core')\n    , ViewportDetectionClass = require('viewport-detection-es6');\n\n_.includes = require('lodash/includes');\nconst viewport = new ViewportDetectionClass();\n\nclass VanillaCollapsibleContentClass{\n  constructor(config = {}, init = true){\n    this.config = _.defaults(config,\n      {\n        bodyContainerClass: 'collapsible-content-body'\n      , itemContainerClass: 'collapsible-content-item'\n      , toggleContainerClass: 'collapsible-content-toggle'\n      }\n    );\n\n    if (init){\n      this._initViewport();\n      this._init();\n    }\n  }\n\n  _init(){\n    this.bodies = [];\n    this.items = [];\n    this.toggles = [];\n    this.dataName = this.config.element.getAttribute('data-name');\n    this._render();\n  }\n\n  _initViewport(){\n    this.device = viewport.getDevice();\n    this.size = viewport.windowSize();\n    viewport.trackSize(this._trackSize.bind(this));\n  }\n\n  _render(){\n    this._getItems();\n    this._getToggles();\n    this._getBodies();\n    this._setBreakpointDefaults();\n  }\n\n  _addToggleClickListeners(){\n    _.forEach(this.toggles, function(toggle){\n      toggle.addEventListener('click'\n                             , this._toggleClick.bind(this, toggle)\n                             , false);\n    }.bind(this));\n  }\n\n  _getBodies(){\n    _.forEach(this.items, function(item){\n      /* eslint-disable max-len */\n      this.bodies.push(item.querySelector('.' + this.config.bodyContainerClass));\n      /* eslint-enable */\n    }.bind(this));\n\n    this._setBodyClasses();\n  }\n\n  _getItems(){\n    let dataParent;\n    /* eslint-disable max-len */\n    let items = this.config.element.querySelectorAll('.' + this.config.itemContainerClass);\n      /* eslint-enable */\n\n    _.forEach(items, function(item){\n      dataParent = item.getAttribute('data-parent');\n\n      if (dataParent === this.dataName){\n        this.items.push(item);\n      }\n    }.bind(this));\n\n    this._setVisibleItems();\n  }\n\n  _getToggles(){\n    _.forEach(this.items, function(item){\n      /* eslint-disable max-len */\n      this.toggles.push(item.querySelector('.' + this.config.toggleContainerClass));\n      /* eslint-disable enable */\n    }.bind(this));\n\n    this._setToggleAriaControls();\n    this._addToggleClickListeners();\n  }\n\n  _setBodyAriaHidden(toggle){\n    let body = this._skipTextNodes(toggle.nextSibling, 'nextSibling');\n    let attribute = body.getAttribute('aria-hidden');\n\n    body.setAttribute('aria-hidden', (attribute === 'true') ? 'false' : 'true');\n  }\n\n  _setBodyClass(toggle){\n    let body = this._skipTextNodes(toggle.nextSibling, 'nextSibling');\n    let className = body.className;\n\n    if (_.includes(className, 'open')){\n      body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n    } else {\n      body.className = className += ' open';\n    }\n  }\n\n  _setBodyClasses(){\n    _.forEach(this.bodies, function(body, i){\n      body.className += (_.isNull(this.dataName)) ? ' collapsible-' + i : ' ' + this.dataName + '-collapsible-' + i;\n    }.bind(this));\n  }\n\n  _setBreakpointDefaults(){\n    switch (this.device){\n      case 'mobile':\n        this._setDefaults(this.visibleMobile);\n        break;\n      case 'tablet':\n        this._setDefaults(this.visibleTablet);\n        break;\n      case 'desktop':\n        this._setDefaults(this.visibleDesktop);\n        break;\n      default:\n        break;\n    }\n  }\n\n  _setDefaultBodyAriaHiddens(visible){\n    _.forEach(this.bodies, function(body){\n      body.setAttribute('aria-hidden', (visible === 'true') ? 'false' : 'true');\n    });\n  }\n\n  _setDefaultBodyClasses(visible){\n    _.forEach(this.bodies, function(body){\n      let className = body.className;\n\n      if (visible === 'true'){\n        if (!_.includes(className, 'open')){\n          body.className = className += ' open';\n        }\n      } else {\n        body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n      }\n    });\n  }\n\n  _setDefaults(visible){\n    this._setDefaultToggleAriaExpandeds(visible);\n    this._setDefaultToggleClasses(visible);\n    this._setDefaultBodyAriaHiddens(visible);\n    this._setDefaultBodyClasses(visible);\n  }\n\n  _setDefaultToggleAriaExpandeds(visible){\n    _.forEach(this.toggles, function(toggle){\n      toggle.setAttribute('aria-expanded', (visible === 'true') ? 'true' : 'false');\n    });\n  }\n\n  _setDefaultToggleClasses(visible){\n    _.forEach(this.toggles, function(toggle){\n      let className = toggle.className;\n\n      if (visible === 'true'){\n        if (!_.includes(className, 'open')){\n          toggle.className = className += ' open';\n        }\n      } else {\n        toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n      }\n    });\n  }\n\n  _setToggleAriaControls(){\n    _.forEach(this.toggles, function(toggle, i){\n      toggle.setAttribute('aria-controls', (_.isNull(this.dataName)) ? 'collapsible-' + i : this.dataName + '-collapsible-' + i);\n    }.bind(this));\n  }\n\n  _setToggleAriaExpanded(toggle){\n    let attribute = toggle.getAttribute('aria-expanded');\n\n    toggle.setAttribute('aria-expanded', (attribute === 'true') ? 'false' : 'true');\n  }\n\n  _setToggleClass(toggle){\n    let className = toggle.className;\n\n    if (_.includes(className, 'open')){\n      toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n    } else {\n      toggle.className = className += ' open';\n    }\n  }\n\n  _setVisibleItems(){\n    let visibleMobile = this.config.element.getAttribute('data-visible-mobile');\n    let visibleTablet = this.config.element.getAttribute('data-visible-tablet');\n    let visibleDesktop = this.config.element.getAttribute('data-visible-desktop');\n\n    this.visibleMobile = (_.isNull(visibleMobile)) ? 'false' : visibleMobile;\n    this.visibleTablet = (_.isNull(visibleTablet)) ? 'false' : visibleTablet;\n    this.visibleDesktop = (_.isNull(visibleDesktop)) ? 'false' : visibleDesktop;\n  }\n\n  _skipTextNodes(el, method){\n    let element = el[method];\n\n    while (element !== null && element.nodeType !== 1){\n      element = element.nextSibling;\n    }\n\n    return element;\n  }\n\n  _toggleClick(toggle, e){\n    e.preventDefault();\n\n    this._setToggleAriaExpanded(toggle);\n    this._setToggleClass(toggle);\n    this._setBodyAriaHidden(toggle);\n    this._setBodyClass(toggle);\n  }\n\n  _trackSize(device, size){\n    if (this.device !== device){\n      this.device = device;\n\n      this._setBreakpointDefaults();\n    }\n\n    this.size = size;\n  }\n}\n\nmodule.exports = VanillaCollapsibleContentClass;\n"]}