{"version":3,"sources":["../src/vanilla-collapsible-content.js"],"names":["_","require","ViewportDetectionClass","includes","viewport","VanillaCollapsibleContentClass","config","init","defaults","bodyContainerClass","itemContainerClass","toggleContainerClass","_initViewport","_init","bodies","items","toggles","dataName","element","getAttribute","_render","device","getDevice","size","windowSize","trackSize","_trackSize","bind","_getItems","_getToggles","_getBodies","_setBreakpointDefaults","forEach","toggle","addEventListener","_toggleClick","item","push","querySelector","_setBodyIDs","dataParent","querySelectorAll","_setVisibleItems","_setToggleAriaControls","_addToggleClickListeners","body","_skipTextNodes","nextSibling","attribute","setAttribute","className","replace","i","id","isNull","_setDefaults","visibleMobile","visibleTablet","visibleDesktop","visible","_setDefaultToggleAriaExpandeds","_setDefaultToggleClasses","_setDefaultBodyAriaHiddens","_setDefaultBodyClasses","el","method","nodeType","e","preventDefault","_setToggleAriaExpanded","_setToggleClass","_setBodyAriaHidden","_setBodyClass","module","exports"],"mappings":";;;;;;AAAA,IAAMA,IAAIC,QAAQ,aAAR,CAAV;AAAA,IACMC,yBAAyBD,QAAQ,wBAAR,CAD/B;;AAGAD,EAAEG,QAAF,GAAaF,QAAQ,iBAAR,CAAb;AACA,IAAMG,WAAW,IAAIF,sBAAJ,EAAjB;;IAEMG,8B;AACJ,4CAAqC;AAAA,QAAzBC,MAAyB,uEAAhB,EAAgB;AAAA,QAAZC,IAAY,uEAAL,IAAK;;AAAA;;AACnC,SAAKD,MAAL,GAAcN,EAAEQ,QAAF,CAAWF,MAAX,EACZ;AACEG,0BAAoB,0BADtB;AAEEC,0BAAoB,0BAFtB;AAGEC,4BAAsB;AAHxB,KADY,CAAd;;AAQA,QAAIJ,IAAJ,EAAS;AACP,WAAKK,aAAL;AACA,WAAKC,KAAL;AACD;AACF;;;;4BAEM;AACL,WAAKC,MAAL,GAAc,EAAd;AACA,WAAKC,KAAL,GAAa,EAAb;AACA,WAAKC,OAAL,GAAe,EAAf;AACA,WAAKC,QAAL,GAAgB,KAAKX,MAAL,CAAYY,OAAZ,CAAoBC,YAApB,CAAiC,WAAjC,CAAhB;AACA,WAAKC,OAAL;AACD;;;oCAEc;AACb,WAAKC,MAAL,GAAcjB,SAASkB,SAAT,EAAd;AACA,WAAKC,IAAL,GAAYnB,SAASoB,UAAT,EAAZ;AACApB,eAASqB,SAAT,CAAmB,KAAKC,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAAnB;AACD;;;8BAEQ;AACP,WAAKC,SAAL;AACA,WAAKC,WAAL;AACA,WAAKC,UAAL;AACA,WAAKC,sBAAL;AACD;;;+CAEyB;AACxB/B,QAAEgC,OAAF,CAAU,KAAKhB,OAAf,EAAwB,UAASiB,MAAT,EAAgB;AACtCA,eAAOC,gBAAP,CAAwB,OAAxB,EACyB,KAAKC,YAAL,CAAkBR,IAAlB,CAAuB,IAAvB,EAA6BM,MAA7B,CADzB,EAEyB,KAFzB;AAGD,OAJuB,CAItBN,IAJsB,CAIjB,IAJiB,CAAxB;AAKD;;;iCAEW;AACV3B,QAAEgC,OAAF,CAAU,KAAKjB,KAAf,EAAsB,UAASqB,IAAT,EAAc;AAClC;AACA,aAAKtB,MAAL,CAAYuB,IAAZ,CAAiBD,KAAKE,aAAL,CAAmB,MAAM,KAAKhC,MAAL,CAAYG,kBAArC,CAAjB;AACA;AACD,OAJqB,CAIpBkB,IAJoB,CAIf,IAJe,CAAtB;;AAMA,WAAKY,WAAL;AACD;;;gCAEU;AACT,UAAIC,mBAAJ;AACA;AACA,UAAIzB,QAAQ,KAAKT,MAAL,CAAYY,OAAZ,CAAoBuB,gBAApB,CAAqC,MAAM,KAAKnC,MAAL,CAAYI,kBAAvD,CAAZ;AACE;;AAEFV,QAAEgC,OAAF,CAAUjB,KAAV,EAAiB,UAASqB,IAAT,EAAc;AAC7BI,qBAAaJ,KAAKjB,YAAL,CAAkB,aAAlB,CAAb;;AAEA,YAAIqB,eAAe,KAAKvB,QAAxB,EAAiC;AAC/B,eAAKF,KAAL,CAAWsB,IAAX,CAAgBD,IAAhB;AACD;AACF,OANgB,CAMfT,IANe,CAMV,IANU,CAAjB;;AAQA,WAAKe,gBAAL;AACD;;;kCAEY;AACX1C,QAAEgC,OAAF,CAAU,KAAKjB,KAAf,EAAsB,UAASqB,IAAT,EAAc;AAClC;AACA,aAAKpB,OAAL,CAAaqB,IAAb,CAAkBD,KAAKE,aAAL,CAAmB,MAAM,KAAKhC,MAAL,CAAYK,oBAArC,CAAlB;AACA;AACD,OAJqB,CAIpBgB,IAJoB,CAIf,IAJe,CAAtB;;AAMA,WAAKgB,sBAAL;AACA,WAAKC,wBAAL;AACD;;;uCAEkBX,M,EAAO;AACxB,UAAIY,OAAO,KAAKC,cAAL,CAAoBb,OAAOc,WAA3B,EAAwC,aAAxC,CAAX;AACA,UAAIC,YAAYH,KAAK1B,YAAL,CAAkB,aAAlB,CAAhB;;AAEA0B,WAAKI,YAAL,CAAkB,aAAlB,EAAkCD,cAAc,MAAf,GAAyB,OAAzB,GAAmC,MAApE;AACD;;;kCAEaf,M,EAAO;AACnB,UAAIY,OAAO,KAAKC,cAAL,CAAoBb,OAAOc,WAA3B,EAAwC,aAAxC,CAAX;AACA,UAAIG,YAAYL,KAAKK,SAArB;;AAEA,UAAIlD,EAAEG,QAAF,CAAW+C,SAAX,EAAsB,MAAtB,CAAJ,EAAkC;AAChCL,aAAKK,SAAL,GAAiBA,UAAUC,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAjB;AACD,OAFD,MAEO;AACLN,aAAKK,SAAL,GAAiBA,aAAa,OAA9B;AACD;AACF;;;kCAEY;AACXlD,QAAEgC,OAAF,CAAU,KAAKlB,MAAf,EAAuB,UAAS+B,IAAT,EAAeO,CAAf,EAAiB;AACtCP,aAAKQ,EAAL,IAAYrD,EAAEsD,MAAF,CAAS,KAAKrC,QAAd,CAAD,oBAA2CmC,CAA3C,GAAoD,KAAKnC,QAAzD,qBAAiFmC,CAA5F;AACD,OAFsB,CAErBzB,IAFqB,CAEhB,IAFgB,CAAvB;AAGD;;;6CAEuB;AACtB,cAAQ,KAAKN,MAAb;AACE,aAAK,QAAL;AACE,eAAKkC,YAAL,CAAkB,KAAKC,aAAvB;AACA;AACF,aAAK,QAAL;AACE,eAAKD,YAAL,CAAkB,KAAKE,aAAvB;AACA;AACF,aAAK,SAAL;AACE,eAAKF,YAAL,CAAkB,KAAKG,cAAvB;AACA;AACF;AACE;AAXJ;AAaD;;;+CAE0BC,O,EAAQ;AACjC3D,QAAEgC,OAAF,CAAU,KAAKlB,MAAf,EAAuB,UAAS+B,IAAT,EAAc;AACnCA,aAAKI,YAAL,CAAkB,aAAlB,EAAkCU,YAAY,MAAb,GAAuB,OAAvB,GAAiC,MAAlE;AACD,OAFD;AAGD;;;2CAEsBA,O,EAAQ;AAC7B3D,QAAEgC,OAAF,CAAU,KAAKlB,MAAf,EAAuB,UAAS+B,IAAT,EAAc;AACnC,YAAIK,YAAYL,KAAKK,SAArB;;AAEA,YAAIS,YAAY,MAAhB,EAAuB;AACrB,cAAI,CAAC3D,EAAEG,QAAF,CAAW+C,SAAX,EAAsB,MAAtB,CAAL,EAAmC;AACjCL,iBAAKK,SAAL,GAAiBA,aAAa,OAA9B;AACD;AACF,SAJD,MAIO;AACLL,eAAKK,SAAL,GAAiBA,UAAUC,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAjB;AACD;AACF,OAVD;AAWD;;;iCAEYQ,O,EAAQ;AACnB,WAAKC,8BAAL,CAAoCD,OAApC;AACA,WAAKE,wBAAL,CAA8BF,OAA9B;AACA,WAAKG,0BAAL,CAAgCH,OAAhC;AACA,WAAKI,sBAAL,CAA4BJ,OAA5B;AACD;;;mDAE8BA,O,EAAQ;AACrC3D,QAAEgC,OAAF,CAAU,KAAKhB,OAAf,EAAwB,UAASiB,MAAT,EAAgB;AACtCA,eAAOgB,YAAP,CAAoB,eAApB,EAAsCU,YAAY,MAAb,GAAuB,MAAvB,GAAgC,OAArE;AACD,OAFD;AAGD;;;6CAEwBA,O,EAAQ;AAC/B3D,QAAEgC,OAAF,CAAU,KAAKhB,OAAf,EAAwB,UAASiB,MAAT,EAAgB;AACtC,YAAIiB,YAAYjB,OAAOiB,SAAvB;;AAEA,YAAIS,YAAY,MAAhB,EAAuB;AACrB,cAAI,CAAC3D,EAAEG,QAAF,CAAW+C,SAAX,EAAsB,MAAtB,CAAL,EAAmC;AACjCjB,mBAAOiB,SAAP,GAAmBA,aAAa,OAAhC;AACD;AACF,SAJD,MAIO;AACLjB,iBAAOiB,SAAP,GAAmBA,UAAUC,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAnB;AACD;AACF,OAVD;AAWD;;;6CAEuB;AACtBnD,QAAEgC,OAAF,CAAU,KAAKhB,OAAf,EAAwB,UAASiB,MAAT,EAAiBmB,CAAjB,EAAmB;AACzCnB,eAAOgB,YAAP,CAAoB,eAApB,EAAsCjD,EAAEsD,MAAF,CAAS,KAAKrC,QAAd,CAAD,GAA4B,iBAAiBmC,CAA7C,GAAiD,KAAKnC,QAAL,GAAgB,eAAhB,GAAkCmC,CAAxH;AACD,OAFuB,CAEtBzB,IAFsB,CAEjB,IAFiB,CAAxB;AAGD;;;2CAEsBM,M,EAAO;AAC5B,UAAIe,YAAYf,OAAOd,YAAP,CAAoB,eAApB,CAAhB;;AAEAc,aAAOgB,YAAP,CAAoB,eAApB,EAAsCD,cAAc,MAAf,GAAyB,OAAzB,GAAmC,MAAxE;AACD;;;oCAEef,M,EAAO;AACrB,UAAIiB,YAAYjB,OAAOiB,SAAvB;;AAEA,UAAIlD,EAAEG,QAAF,CAAW+C,SAAX,EAAsB,MAAtB,CAAJ,EAAkC;AAChCjB,eAAOiB,SAAP,GAAmBA,UAAUC,OAAV,CAAkB,qBAAlB,EAAyC,EAAzC,CAAnB;AACD,OAFD,MAEO;AACLlB,eAAOiB,SAAP,GAAmBA,aAAa,OAAhC;AACD;AACF;;;uCAEiB;AAChB,UAAIM,gBAAgB,KAAKlD,MAAL,CAAYY,OAAZ,CAAoBC,YAApB,CAAiC,qBAAjC,CAApB;AACA,UAAIsC,gBAAgB,KAAKnD,MAAL,CAAYY,OAAZ,CAAoBC,YAApB,CAAiC,qBAAjC,CAApB;AACA,UAAIuC,iBAAiB,KAAKpD,MAAL,CAAYY,OAAZ,CAAoBC,YAApB,CAAiC,sBAAjC,CAArB;;AAEA,WAAKqC,aAAL,GAAsBxD,EAAEsD,MAAF,CAASE,aAAT,CAAD,GAA4B,OAA5B,GAAsCA,aAA3D;AACA,WAAKC,aAAL,GAAsBzD,EAAEsD,MAAF,CAASG,aAAT,CAAD,GAA4B,OAA5B,GAAsCA,aAA3D;AACA,WAAKC,cAAL,GAAuB1D,EAAEsD,MAAF,CAASI,cAAT,CAAD,GAA6B,OAA7B,GAAuCA,cAA7D;AACD;;;mCAEcM,E,EAAIC,M,EAAO;AACxB,UAAI/C,UAAU8C,GAAGC,MAAH,CAAd;;AAEA,aAAO/C,YAAY,IAAZ,IAAoBA,QAAQgD,QAAR,KAAqB,CAAhD,EAAkD;AAChDhD,kBAAUA,QAAQ6B,WAAlB;AACD;;AAED,aAAO7B,OAAP;AACD;;;iCAEYe,M,EAAQkC,C,EAAE;AACrBA,QAAEC,cAAF;;AAEA,WAAKC,sBAAL,CAA4BpC,MAA5B;AACA,WAAKqC,eAAL,CAAqBrC,MAArB;AACA,WAAKsC,kBAAL,CAAwBtC,MAAxB;AACA,WAAKuC,aAAL,CAAmBvC,MAAnB;AACD;;;+BAEUZ,M,EAAQE,I,EAAK;AACtB,UAAI,KAAKF,MAAL,KAAgBA,MAApB,EAA2B;AACzB,aAAKA,MAAL,GAAcA,MAAd;;AAEA,aAAKU,sBAAL;AACD;;AAED,WAAKR,IAAL,GAAYA,IAAZ;AACD;;;;;;AAGHkD,OAAOC,OAAP,GAAiBrE,8BAAjB","file":"vanilla-collapsible-content.js","sourcesContent":["const _ = require('lodash/core')\n    , ViewportDetectionClass = require('viewport-detection-es6');\n\n_.includes = require('lodash/includes');\nconst viewport = new ViewportDetectionClass();\n\nclass VanillaCollapsibleContentClass{\n  constructor(config = {}, init = true){\n    this.config = _.defaults(config,\n      {\n        bodyContainerClass: 'collapsible-content-body'\n      , itemContainerClass: 'collapsible-content-item'\n      , toggleContainerClass: 'collapsible-content-toggle'\n      }\n    );\n\n    if (init){\n      this._initViewport();\n      this._init();\n    }\n  }\n\n  _init(){\n    this.bodies = [];\n    this.items = [];\n    this.toggles = [];\n    this.dataName = this.config.element.getAttribute('data-name');\n    this._render();\n  }\n\n  _initViewport(){\n    this.device = viewport.getDevice();\n    this.size = viewport.windowSize();\n    viewport.trackSize(this._trackSize.bind(this));\n  }\n\n  _render(){\n    this._getItems();\n    this._getToggles();\n    this._getBodies();\n    this._setBreakpointDefaults();\n  }\n\n  _addToggleClickListeners(){\n    _.forEach(this.toggles, function(toggle){\n      toggle.addEventListener('click'\n                             , this._toggleClick.bind(this, toggle)\n                             , false);\n    }.bind(this));\n  }\n\n  _getBodies(){\n    _.forEach(this.items, function(item){\n      /* eslint-disable max-len */\n      this.bodies.push(item.querySelector('.' + this.config.bodyContainerClass));\n      /* eslint-enable */\n    }.bind(this));\n\n    this._setBodyIDs();\n  }\n\n  _getItems(){\n    let dataParent;\n    /* eslint-disable max-len */\n    let items = this.config.element.querySelectorAll('.' + this.config.itemContainerClass);\n      /* eslint-enable */\n\n    _.forEach(items, function(item){\n      dataParent = item.getAttribute('data-parent');\n\n      if (dataParent === this.dataName){\n        this.items.push(item);\n      }\n    }.bind(this));\n\n    this._setVisibleItems();\n  }\n\n  _getToggles(){\n    _.forEach(this.items, function(item){\n      /* eslint-disable max-len */\n      this.toggles.push(item.querySelector('.' + this.config.toggleContainerClass));\n      /* eslint-disable enable */\n    }.bind(this));\n\n    this._setToggleAriaControls();\n    this._addToggleClickListeners();\n  }\n\n  _setBodyAriaHidden(toggle){\n    let body = this._skipTextNodes(toggle.nextSibling, 'nextSibling');\n    let attribute = body.getAttribute('aria-hidden');\n\n    body.setAttribute('aria-hidden', (attribute === 'true') ? 'false' : 'true');\n  }\n\n  _setBodyClass(toggle){\n    let body = this._skipTextNodes(toggle.nextSibling, 'nextSibling');\n    let className = body.className;\n\n    if (_.includes(className, 'open')){\n      body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n    } else {\n      body.className = className += ' open';\n    }\n  }\n\n  _setBodyIDs(){\n    _.forEach(this.bodies, function(body, i){\n      body.id += (_.isNull(this.dataName)) ? `collapsible-${i}` : `${this.dataName}-collapsible-${i}`;\n    }.bind(this));\n  }\n\n  _setBreakpointDefaults(){\n    switch (this.device){\n      case 'mobile':\n        this._setDefaults(this.visibleMobile);\n        break;\n      case 'tablet':\n        this._setDefaults(this.visibleTablet);\n        break;\n      case 'desktop':\n        this._setDefaults(this.visibleDesktop);\n        break;\n      default:\n        break;\n    }\n  }\n\n  _setDefaultBodyAriaHiddens(visible){\n    _.forEach(this.bodies, function(body){\n      body.setAttribute('aria-hidden', (visible === 'true') ? 'false' : 'true');\n    });\n  }\n\n  _setDefaultBodyClasses(visible){\n    _.forEach(this.bodies, function(body){\n      let className = body.className;\n\n      if (visible === 'true'){\n        if (!_.includes(className, 'open')){\n          body.className = className += ' open';\n        }\n      } else {\n        body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n      }\n    });\n  }\n\n  _setDefaults(visible){\n    this._setDefaultToggleAriaExpandeds(visible);\n    this._setDefaultToggleClasses(visible);\n    this._setDefaultBodyAriaHiddens(visible);\n    this._setDefaultBodyClasses(visible);\n  }\n\n  _setDefaultToggleAriaExpandeds(visible){\n    _.forEach(this.toggles, function(toggle){\n      toggle.setAttribute('aria-expanded', (visible === 'true') ? 'true' : 'false');\n    });\n  }\n\n  _setDefaultToggleClasses(visible){\n    _.forEach(this.toggles, function(toggle){\n      let className = toggle.className;\n\n      if (visible === 'true'){\n        if (!_.includes(className, 'open')){\n          toggle.className = className += ' open';\n        }\n      } else {\n        toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n      }\n    });\n  }\n\n  _setToggleAriaControls(){\n    _.forEach(this.toggles, function(toggle, i){\n      toggle.setAttribute('aria-controls', (_.isNull(this.dataName)) ? 'collapsible-' + i : this.dataName + '-collapsible-' + i);\n    }.bind(this));\n  }\n\n  _setToggleAriaExpanded(toggle){\n    let attribute = toggle.getAttribute('aria-expanded');\n\n    toggle.setAttribute('aria-expanded', (attribute === 'true') ? 'false' : 'true');\n  }\n\n  _setToggleClass(toggle){\n    let className = toggle.className;\n\n    if (_.includes(className, 'open')){\n      toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, '');\n    } else {\n      toggle.className = className += ' open';\n    }\n  }\n\n  _setVisibleItems(){\n    let visibleMobile = this.config.element.getAttribute('data-visible-mobile');\n    let visibleTablet = this.config.element.getAttribute('data-visible-tablet');\n    let visibleDesktop = this.config.element.getAttribute('data-visible-desktop');\n\n    this.visibleMobile = (_.isNull(visibleMobile)) ? 'false' : visibleMobile;\n    this.visibleTablet = (_.isNull(visibleTablet)) ? 'false' : visibleTablet;\n    this.visibleDesktop = (_.isNull(visibleDesktop)) ? 'false' : visibleDesktop;\n  }\n\n  _skipTextNodes(el, method){\n    let element = el[method];\n\n    while (element !== null && element.nodeType !== 1){\n      element = element.nextSibling;\n    }\n\n    return element;\n  }\n\n  _toggleClick(toggle, e){\n    e.preventDefault();\n\n    this._setToggleAriaExpanded(toggle);\n    this._setToggleClass(toggle);\n    this._setBodyAriaHidden(toggle);\n    this._setBodyClass(toggle);\n  }\n\n  _trackSize(device, size){\n    if (this.device !== device){\n      this.device = device;\n\n      this._setBreakpointDefaults();\n    }\n\n    this.size = size;\n  }\n}\n\nmodule.exports = VanillaCollapsibleContentClass;\n"]}